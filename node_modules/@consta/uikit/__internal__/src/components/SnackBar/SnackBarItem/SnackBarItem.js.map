{"version":3,"file":"SnackBarItem.js","names":["IconClose","React","useEffect","useState","Button","Text","useTheme","useFlag","cnMixFlex","cnMixSpace","cn","isNumber","isString","SnackBarActionButton","SnackBarLine","SnackBarProgress","SnackBarTimer","snackBarItemStatusDefault","snackBarPropFormDefault","snackBarPropProgressViewDefault","defaultInitialTimerTime","cnSnackBarItem","getAutoCloseTime","autoClose","SnackBarItemRender","props","ref","onClose","showProgress","Icon","icon","form","message","actions","status","onAutoCloseProp","onAutoClose","className","progressView","progress","style","otherProps","themeClassNames","timerFunctions","setTimerFunctions","hover","onHover","on","offHover","off","timeIsOver","onTimeIsOver","handleMountTimer","autoCloseTime","hideAutoCloseTimer","pause","start","handleTimeIsOver","handleClose","visibleProgress","flex","gap","p","color","accent","handleMouseEnter","handleMouseLeave","direction","pR","align","justify","SnackBarItem","forwardRef"],"sources":["../../../../../../src/components/SnackBar/SnackBarItem/SnackBarItem.tsx"],"sourcesContent":["import './SnackBarItem.css';\n\nimport { IconClose } from '@consta/icons/IconClose';\nimport React, { useEffect, useState } from 'react';\n\nimport { Button } from '##/components/Button';\nimport { Text } from '##/components/Text';\nimport { useTheme } from '##/components/Theme';\nimport { useFlag } from '##/hooks/useFlag';\nimport { cnMixFlex } from '##/mixs/MixFlex';\nimport { cnMixSpace } from '##/mixs/MixSpace';\nimport { cn } from '##/utils/bem';\nimport { isNumber, isString } from '##/utils/type-guards';\n\nimport { SnackBarActionButton } from '../SnackBarActionButton';\nimport { SnackBarLine } from '../SnackBarLine/SnackBarLine';\nimport { SnackBarProgress } from '../SnackBarProgress';\nimport { SnackBarTimer } from '../SnackBarTimer/SnackBarTimer';\nimport {\n  SnackBarItemComponent,\n  SnackBarItemProps,\n  snackBarItemStatusDefault,\n  snackBarPropFormDefault,\n  snackBarPropProgressViewDefault,\n  SnackBarTimerPropOnMount,\n} from '../types';\n\nconst defaultInitialTimerTime = 3;\n\nexport const cnSnackBarItem = cn('SnackBarItem');\n\nconst getAutoCloseTime = (\n  autoClose: boolean | number | undefined,\n): number | false => {\n  if (autoClose) {\n    if (typeof autoClose === 'number') {\n      return autoClose;\n    }\n    return defaultInitialTimerTime;\n  }\n  return false;\n};\n\nexport const SnackBarItemRender = (\n  props: SnackBarItemProps,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const {\n    onClose,\n    autoClose,\n    showProgress,\n    icon: Icon,\n    form = snackBarPropFormDefault,\n    message,\n    actions,\n    status = snackBarItemStatusDefault,\n    onAutoClose: onAutoCloseProp,\n    className,\n    progressView = snackBarPropProgressViewDefault,\n    progress,\n    style,\n    ...otherProps\n  } = props;\n\n  const { themeClassNames } = useTheme();\n\n  const [timerFunctions, setTimerFunctions] = useState<{\n    start: () => void;\n    pause: () => void;\n  } | null>(null);\n  const [hover, { on: onHover, off: offHover }] = useFlag(false);\n  const [timeIsOver, { on: onTimeIsOver }] = useFlag(false);\n  const handleMountTimer: SnackBarTimerPropOnMount = (timerFunctions) =>\n    setTimerFunctions(timerFunctions);\n  const handleMouseEnter = () => onHover();\n  const handleMouseLeave = () => offHover();\n  const autoCloseTime = getAutoCloseTime(autoClose);\n  const hideAutoCloseTimer =\n    showProgress === undefined ||\n    !(isNumber(autoCloseTime) && autoCloseTime > 0);\n  const onAutoClose = () => {\n    if (onAutoCloseProp) {\n      onAutoCloseProp();\n    } else {\n      onClose?.();\n    }\n  };\n\n  useEffect(() => {\n    if (!timeIsOver) {\n      if (hover) {\n        timerFunctions && timerFunctions.pause();\n      } else {\n        timerFunctions && timerFunctions.start();\n      }\n    }\n  }, [hover, timeIsOver, timerFunctions]);\n\n  const handleTimeIsOver = () => {\n    onTimeIsOver();\n    onAutoClose();\n  };\n\n  const handleClose = onClose ? () => onClose() : undefined;\n  const visibleProgress = isNumber(progress) || progress === true;\n\n  return (\n    <div\n      ref={ref}\n      className={cnSnackBarItem({ showProgress, form }, [\n        cnMixFlex({ flex: 'flex', gap: 'm' }),\n        cnMixSpace({ p: 'm' }),\n        themeClassNames.color.accent,\n        className,\n      ])}\n      onMouseEnter={autoCloseTime ? handleMouseEnter : undefined}\n      onMouseLeave={autoCloseTime ? handleMouseLeave : undefined}\n      style={{\n        ...style,\n        ['--snack-bar-item-bg' as string]: `var(--color-bg-${status})`,\n      }}\n      {...otherProps}\n    >\n      {autoCloseTime && showProgress !== 'line' && (\n        <SnackBarTimer\n          className={cnSnackBarItem('Timer')}\n          onMount={handleMountTimer}\n          onTimeIsOver={handleTimeIsOver}\n          startTime={autoCloseTime}\n          hidden={hideAutoCloseTimer}\n        />\n      )}\n      {Icon &&\n        ((hideAutoCloseTimer && showProgress === 'timer') ||\n          showProgress !== 'timer') && (\n          <Icon className={cnSnackBarItem('Icon')} size=\"m\" />\n        )}\n      <div\n        className={cnSnackBarItem(\n          'Content',\n          cnMixFlex({ flex: 'flex', gap: 's', direction: 'column' }),\n        )}\n      >\n        <div className={onClose ? cnMixSpace({ pR: 'm' }) : undefined}>\n          {isString(message) || isNumber(message) ? (\n            <Text\n              view=\"primary\"\n              size=\"m\"\n              className={cnSnackBarItem('Message')}\n              lineHeight=\"s\"\n            >\n              {message}\n            </Text>\n          ) : (\n            message\n          )}\n        </div>\n        {(visibleProgress || actions) && (\n          <div\n            className={cnSnackBarItem('Actions', [\n              cnMixFlex({\n                flex: 'flex',\n                align: 'flex-end',\n                gap: 's',\n                justify: 'flex-end',\n              }),\n            ])}\n          >\n            {actions && (\n              <SnackBarActionButton\n                className={cnSnackBarItem('ActionButtons')}\n                actions={actions}\n                form={form}\n              />\n            )}\n            {visibleProgress && (\n              <SnackBarProgress progress={progress} view={progressView} />\n            )}\n          </div>\n        )}\n      </div>\n\n      {onClose && (\n        <Button\n          className={cnSnackBarItem('CloseButton')}\n          view=\"clear\"\n          iconLeft={IconClose}\n          form=\"round\"\n          type=\"button\"\n          size=\"xs\"\n          onClick={handleClose}\n        />\n      )}\n      {autoCloseTime && showProgress === 'line' && (\n        <SnackBarLine\n          className={cnSnackBarItem('Line')}\n          onMount={handleMountTimer}\n          onTimeIsOver={handleTimeIsOver}\n          startTime={autoCloseTime}\n        />\n      )}\n    </div>\n  );\n};\n\nexport const SnackBarItem = React.forwardRef(\n  SnackBarItemRender,\n) as SnackBarItemComponent;\n"],"mappings":"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"}