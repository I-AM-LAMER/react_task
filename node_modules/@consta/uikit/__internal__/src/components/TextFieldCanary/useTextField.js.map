{"version":3,"file":"useTextField.js","names":["useCallback","useEffect","useRef","useFlag","useMutableRef","useTextField","onClick","onChange","onBlur","onFocus","disabled","onClear","ref","inputRef","focused","setFocused","withValue","setWithValue","mutableRefs","handleFocus","e","on","current","handleBlur","off","handleClear","value","handleChange","target","handleClick","focus"],"sources":["../../../../../src/components/TextFieldCanary/useTextField.ts"],"sourcesContent":["import React, { useCallback, useEffect, useRef } from 'react';\n\nimport { useFlag } from '##/hooks/useFlag';\nimport { useMutableRef } from '##/hooks/useMutableRef/useMutableRef';\n\nimport { TextFieldPropOnChange } from './types';\n\nexport const useTextField = <\n  INPUT_ELEMENT extends\n    | HTMLInputElement\n    | HTMLTextAreaElement = HTMLInputElement,\n>({\n  onClick,\n  onChange,\n  onBlur,\n  onFocus,\n  disabled,\n  onClear,\n}: {\n  onClick: React.MouseEventHandler<HTMLDivElement> | undefined;\n  onChange: TextFieldPropOnChange<string> | undefined;\n  onBlur: React.FocusEventHandler<HTMLElement> | undefined;\n  onFocus: React.FocusEventHandler<HTMLElement> | undefined;\n  disabled: boolean | undefined;\n  onClear: React.MouseEventHandler<HTMLButtonElement> | undefined;\n}) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<INPUT_ELEMENT>(null);\n  const [focused, setFocused] = useFlag();\n  const [withValue, setWithValue] = useFlag();\n\n  const mutableRefs = useMutableRef([\n    onChange,\n    onClick,\n    onBlur,\n    onFocus,\n    disabled,\n    onClear,\n  ] as const);\n\n  const handleFocus: React.FocusEventHandler<HTMLElement> = useCallback((e) => {\n    setFocused.on();\n    mutableRefs.current[3]?.(e);\n  }, []);\n\n  const handleBlur: React.FocusEventHandler<HTMLElement> = useCallback((e) => {\n    setFocused.off();\n    mutableRefs.current[2]?.(e);\n  }, []);\n\n  const handleClear = useCallback((e: React.MouseEvent<HTMLButtonElement>) => {\n    if (mutableRefs.current[4]) {\n      return;\n    }\n\n    if (mutableRefs.current[5]) {\n      mutableRefs.current[5]?.(e);\n    } else {\n      mutableRefs.current[0]?.(null, { e });\n      if (inputRef.current && inputRef.current.value !== '') {\n        inputRef.current.value = '';\n      }\n    }\n  }, []);\n\n  const handleChange: React.ChangeEventHandler<INPUT_ELEMENT> = useCallback(\n    (e) => {\n      if (mutableRefs.current[4]) {\n        return;\n      }\n\n      mutableRefs.current[0]?.(e.target.value || null, { e });\n\n      setWithValue[e.target.value ? 'on' : 'off']();\n    },\n    [],\n  );\n\n  const handleClick = useCallback(\n    (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      inputRef.current?.focus();\n      mutableRefs.current[1]?.(e);\n    },\n    [],\n  );\n\n  useEffect(() => {\n    setWithValue[inputRef.current?.value ? 'on' : 'off']();\n  }, [inputRef.current?.value]);\n\n  return {\n    ref,\n    inputRef,\n    focused,\n    withValue,\n    handleFocus,\n    handleBlur,\n    handleClear,\n    handleChange,\n    handleClick,\n    mutableRefs,\n    setWithValue,\n  };\n};\n"],"mappings":"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"}