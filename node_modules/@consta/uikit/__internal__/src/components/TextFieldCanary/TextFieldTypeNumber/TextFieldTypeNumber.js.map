{"version":3,"file":"TextFieldTypeNumber.js","names":["React","forwardRef","useCallback","useMemo","FieldClearButton","FieldControlLayout","FieldCounter","FieldInput","renderSide","useForkRef","useKeys","useMutableRef","useSortSteps","useTextField","cnTextFieldTypeNumber","getValueByStep","stepIsActive","TextFieldTypeNumber","props","componentRef","className","value","defaultValue","onChange","id","name","inputRefProp","inputRef","maxLength","disabled","size","view","form","status","onBlur","onFocus","autoFocus","placeholder","leftSide","rightSide","autoComplete","withClearButton","readOnly","type","tabIndex","ariaLabel","iconSize","onClick","incrementButtons","max","min","step","onKeyDown","onKeyDownCapture","onKeyUp","onKeyUpCapture","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onClear","onWheel","otherProps","handleBlur","handleChange","handleClear","handleFocus","focused","withValue","ref","handleClick","mutableRefs","setWithValue","sortSteps","refs","changeNumberValue","e","isIncrement","current","newValue","on","handleIncrementButton","handleDecrementButton","handleInputKeyDown","isActive","keys","ArrowUp","preventDefault","ArrowDown","onEvent","handleWheel","blur"],"sources":["../../../../../../src/components/TextFieldCanary/TextFieldTypeNumber/TextFieldTypeNumber.tsx"],"sourcesContent":["import React, { forwardRef, useCallback, useMemo } from 'react';\n\nimport {\n  FieldClearButton,\n  FieldControlLayout,\n  FieldCounter,\n  FieldInput,\n  renderSide,\n} from '##/components/FieldComponents';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { useKeys } from '##/hooks/useKeys';\nimport { useMutableRef } from '##/hooks/useMutableRef/useMutableRef';\nimport { useSortSteps } from '##/hooks/useSortSteps';\n\nimport { TextFieldTypeComponent } from '../types';\nimport { useTextField } from '../useTextField';\nimport { cnTextFieldTypeNumber } from './cnTextFieldTypeNumber';\nimport { getValueByStep, stepIsActive } from './helpers';\n\nexport const TextFieldTypeNumber: TextFieldTypeComponent<'number'> = forwardRef(\n  (props, componentRef) => {\n    const {\n      className,\n      value,\n      defaultValue,\n      onChange,\n      id,\n      name,\n      inputRef: inputRefProp,\n      maxLength,\n      disabled,\n      size = 'm',\n      view = 'default',\n      form,\n      status,\n      onBlur,\n      onFocus,\n      autoFocus,\n      placeholder,\n      leftSide,\n      rightSide,\n      autoComplete,\n      withClearButton,\n      readOnly,\n      type,\n      tabIndex,\n      ariaLabel,\n      iconSize,\n      onClick,\n      incrementButtons,\n      max,\n      min,\n      step,\n      // onKey props\n      onKeyDown,\n      onKeyDownCapture,\n      onKeyUp,\n      onKeyUpCapture,\n      onCopy,\n      onCopyCapture,\n      onCut,\n      onCutCapture,\n      onPaste,\n      onPasteCapture,\n      onClear,\n      onWheel,\n      ...otherProps\n    } = props;\n\n    const {\n      handleBlur,\n      handleChange,\n      handleClear,\n      handleFocus,\n      focused,\n      withValue,\n      ref,\n      inputRef,\n      handleClick,\n      mutableRefs,\n      setWithValue,\n    } = useTextField({\n      onClick,\n      onChange,\n      onBlur,\n      onFocus,\n      disabled,\n      onClear,\n    });\n\n    const sortSteps = useSortSteps({ step, min, max });\n\n    const refs = useMutableRef([\n      sortSteps,\n      min,\n      max,\n      onKeyDown,\n      stepIsActive(sortSteps, disabled),\n      onWheel,\n    ] as const);\n\n    const changeNumberValue = useCallback(\n      <T extends React.MouseEvent<HTMLButtonElement> | React.KeyboardEvent>(\n        e: T,\n        isIncrement: boolean,\n      ) => {\n        if (!inputRef.current || mutableRefs.current[4]) {\n          return;\n        }\n\n        const newValue = getValueByStep(\n          refs.current[0],\n          inputRef.current.value,\n          isIncrement,\n          refs.current[1],\n          refs.current[2],\n        );\n\n        mutableRefs.current[0]?.(newValue, { e });\n\n        inputRef.current.value = newValue;\n        setWithValue.on();\n      },\n      [],\n    );\n\n    const handleIncrementButton = useCallback(\n      (e: React.MouseEvent<HTMLButtonElement>) => changeNumberValue(e, true),\n      [],\n    );\n\n    const handleDecrementButton = useCallback(\n      (e: React.MouseEvent<HTMLButtonElement>) => changeNumberValue(e, false),\n      [],\n    );\n\n    const handleInputKeyDown = useKeys(\n      useMemo(\n        () => ({\n          isActive: true,\n          keys: {\n            ArrowUp: (e) => {\n              e.preventDefault();\n              refs.current[4] && changeNumberValue(e, true);\n            },\n            ArrowDown: (e) => {\n              e.preventDefault();\n              refs.current[4] && changeNumberValue(e, false);\n            },\n          },\n          onEvent: refs.current[3],\n        }),\n        [],\n      ),\n    );\n\n    const handleWheel = useCallback((e: React.WheelEvent<HTMLInputElement>) => {\n      if (refs.current[5]) {\n        refs.current[5](e);\n      } else {\n        inputRef.current?.blur();\n      }\n    }, []);\n\n    return (\n      <FieldControlLayout\n        {...otherProps}\n        className={cnTextFieldTypeNumber({ incrementButtons }, [className])}\n        form={form}\n        status={status}\n        size={size}\n        leftSide={renderSide(leftSide, size, iconSize)}\n        rightSide={[\n          withClearButton && !disabled && withValue && !incrementButtons && (\n            <FieldClearButton size={size} onClick={handleClear} />\n          ),\n          incrementButtons && refs.current[4] && (\n            <FieldCounter\n              onIncrementClick={handleIncrementButton}\n              onIncrementFocus={handleFocus}\n              onDecrementClick={handleDecrementButton}\n              onDecrementFocus={handleFocus}\n            />\n          ),\n        ]}\n        focused={focused}\n        view={view}\n        ref={useForkRef([componentRef, ref])}\n        disabled={disabled}\n        onClick={handleClick}\n      >\n        <FieldInput\n          className={cnTextFieldTypeNumber('Input')}\n          placeholder={placeholder}\n          autoFocus={autoFocus}\n          autoComplete={autoComplete}\n          onBlur={handleBlur}\n          onChange={handleChange}\n          onFocus={handleFocus}\n          defaultValue={defaultValue || undefined}\n          value={value === null ? '' : value}\n          ref={useForkRef([inputRefProp, inputRef])}\n          readOnly={readOnly}\n          tabIndex={tabIndex}\n          aria-label={ariaLabel}\n          onKeyDown={handleInputKeyDown}\n          onKeyDownCapture={onKeyDownCapture}\n          onKeyUp={onKeyUp}\n          onKeyUpCapture={onKeyUpCapture}\n          onWheel={handleWheel}\n          maxLength={maxLength}\n          disabled={disabled}\n          type={type}\n          max={max}\n          min={min}\n          id={id}\n          name={name}\n          onCopy={onCopy}\n          onCopyCapture={onCopyCapture}\n          onCut={onCut}\n          onCutCapture={onCutCapture}\n          onPaste={onPaste}\n          onPasteCapture={onPasteCapture}\n        />\n      </FieldControlLayout>\n    );\n  },\n);\n"],"mappings":"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"}