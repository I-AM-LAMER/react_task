import _defineProperty from"@babel/runtime/helpers/defineProperty";import _toConsumableArray from"@babel/runtime/helpers/toConsumableArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["className","value","defaultValue","onChange","id","name","inputRef","maxLength","disabled","size","view","form","status","onBlur","onFocus","autoFocus","placeholder","leftSide","rightSide","autoComplete","withClearButton","readOnly","type","tabIndex","ariaLabel","iconSize","onClick","style","inputValue","renderValueItem","onInputChange","onKeyDown","onKeyDownCapture","onKeyUp","onKeyUpCapture","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onClear","onWheel"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import React,{forwardRef,useCallback,useEffect,useMemo,useRef}from"react";import{FieldArrayValueInlineControl,FieldArrayValueItem,FieldClearButton,FieldControlLayout,renderSide}from"../../FieldComponents";import{useComponentSize}from"../../../hooks/useComponentSize";import{useForkRef}from"../../../hooks/useForkRef";import{useKeys}from"../../../hooks/useKeys";import{useMutableRef}from"../../../hooks/useMutableRef";import{useRefs}from"../../../hooks/useRefs";import{getElementWidth,useResizeObserved}from"../../../hooks/useResizeObserved";import{getStyleProps}from"../../../hooks/useStyleProps";import{cnMixScrollBar}from"../../../mixs/MixScrollBar";import{useTextField}from"../useTextField";import{cnTextFieldTypeTextArray}from"./cnTextFieldTypeTextArray";var defaultRenderValueItem=function(a){var b=a.item,c=a.index,d=a.size,e=a.disabled,f=a.onRemove;return React.createElement(FieldArrayValueItem,{key:c,size:d,label:b,disabled:e,onRemove:f})};export var TextFieldTypeTextArray=forwardRef(function(a,b){var c,d=a.className,f=a.value,g=a.defaultValue,h=a.onChange,i=a.id,e=a.name,j=a.inputRef,k=a.maxLength,l=a.disabled,m=a.size,n=void 0===m?"m":m,o=a.view,p=void 0===o?"default":o,q=a.form,r=a.status,s=a.onBlur,t=a.onFocus,u=a.autoFocus,v=a.placeholder,w=a.leftSide,x=a.rightSide,y=a.autoComplete,z=a.withClearButton,A=a.readOnly,B=a.type,C=a.tabIndex,D=a.ariaLabel,E=a.iconSize,F=a.onClick,G=a.style,H=a.inputValue,I=a.renderValueItem,J=void 0===I?defaultRenderValueItem:I,K=a.onInputChange,L=a.onKeyDown,M=a.onKeyDownCapture,N=a.onKeyUp,O=a.onKeyUpCapture,P=a.onCopy,Q=a.onCopyCapture,R=a.onCut,S=a.onCutCapture,T=a.onPaste,U=a.onPasteCapture,V=a.onClear,W=a.onWheel,X=_objectWithoutProperties(a,_excluded),Y=useTextField({onClick:F,onChange:K,onBlur:s,onFocus:t,disabled:l,onClear:void 0}),Z=Y.handleBlur,$=Y.handleChange,_=Y.handleClear,aa=Y.handleFocus,ba=Y.focused,ca=Y.withValue,da=Y.ref,ea=Y.inputRef,fa=Y.handleClick,ga=ca||!!(null!==f&&void 0!==f&&f.length),ha=useRef(null),ia=useRef(null),ja=useMutableRef([h,_,f]),ka=function(a){return function(b){if(null!==f&&void 0!==f&&f.length){var c=_toConsumableArray(f);c.splice(a,1),null===h||void 0===h?void 0:h(c.length?c:null,{e:b})}}},la=useCallback(function(a){var b;if(ja.current[1](a),null!==(b=ja.current[2])&&void 0!==b&&b.length){var c,d;null===(c=(d=ja.current)[0])||void 0===c?void 0:c.call(d,null,{e:a})}},[]),ma=useMemo(function(){return{Enter:function Enter(a){var b=a.target.value;if(b){var c,d;null===(c=(d=ja.current)[0])||void 0===c?void 0:c.call(d,[].concat(_toConsumableArray(ja.current[2]||[]),[b]),{e:a}),ha.current&&ha.current.scrollTo({top:ha.current.scrollHeight})}},Backspace:function Backspace(a){var b=a.target.value,c=ja.current[2];if(!b&&null!==c&&void 0!==c&&c.length){var d,e;a.preventDefault();var f=_toConsumableArray(c);f.pop(),null===(d=(e=ja.current)[0])||void 0===d?void 0:d.call(e,f,{e:a})}}}},[]),na=useKeys({isActive:!!h,keys:ma,onEvent:L}),oa=useRefs(2,[!!x,z&&!l&&ga]),pa=useComponentSize(ha),qa=useResizeObserved(oa,getElementWidth),ra=da.current?getStyleProps(da.current,["max-height","height"]):void 0;return useEffect(function(){ha.current&&ia.current&&ba&&ia.current.scrollTo({top:pa.height})},[pa.height]),useEffect(function(){ea.current&&ea.current.value!==H&&(ea.current.value=H||"")},[H,ea.current]),React.createElement(FieldControlLayout,Object.assign({},X,{className:cnTextFieldTypeTextArray(null,[d]),form:q,status:r,size:n,leftSide:renderSide(w,n,E),rightSide:[z&&!l&&ga&&React.createElement(FieldClearButton,{size:n,onClick:V||la}),renderSide(x,n,E)],focused:ba,view:p,ref:useForkRef([b,da]),disabled:l,onClick:fa,rightSlotsRefs:oa,style:_objectSpread(_objectSpread({},G),{},(c={},_defineProperty(c,"--text-field-textarray-max-height",(null===ra||void 0===ra?void 0:ra["max-height"])||(null===ra||void 0===ra?void 0:ra.height)||"auto"),_defineProperty(c,"--text-field-textarray-slot-sizes-width","".concat(qa.reduce(function(c,a){return c+a}),"px")),_defineProperty(c,"--text-field-textarray-slot-sizes-length",qa.filter(function(a){return!!a}).length),c))}),React.createElement("div",{ref:ia,className:cnTextFieldTypeTextArray("ScrollWrapper",[cnMixScrollBar({size:"xs"})])},React.createElement(FieldArrayValueInlineControl,{size:n,inputRef:useForkRef([ea,j]),value:null!==f&&void 0!==f?f:void 0,onFocus:aa,onBlur:Z,onChange:$,autoFocus:u,onKeyDown:na,ref:ha,placeholder:v,renderValue:function renderValue(a,b){return J({item:a,index:b,size:n,disabled:l,onRemove:ka(b)})},onCopy:P,onCopyCapture:Q,onCut:R,onCutCapture:S,onPaste:T,onPasteCapture:U,inputTabIndex:C,onKeyDownCapture:M,onKeyUp:N,onKeyUpCapture:O,onWheel:W})))});
//# sourceMappingURL=TextFieldTypeTextArray.js.map