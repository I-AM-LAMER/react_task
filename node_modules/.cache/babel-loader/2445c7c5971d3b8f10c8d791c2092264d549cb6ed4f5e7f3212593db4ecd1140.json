{"ast":null,"code":"var _jsxFileName = \"/home/vadim/Desktop/react_task/src/pages/login-page/LoginPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport styles from './LoginPage.module.css';\nimport { Button } from '@consta/uikit/Button';\nimport { useDispatch } from 'react-redux';\nimport { login } from '../../components/app/slices/authSlice';\nimport { set_user } from '../../components/app/slices/userSlice';\nimport NavBar from '../../layouts/navigationBar';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LoginPage() {\n  _s();\n  let dispatch = useDispatch();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState({\n    username: '',\n    password: ''\n  });\n  const navigate = useNavigate();\n  const validatePassword = password => {\n    return password.length >= 6 && /[a-zA-Z]/.test(password);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setErrors({\n      username: '',\n      password: ''\n    });\n    if (!validatePassword(password)) {\n      setErrors(prev => ({\n        ...prev,\n        password: 'Пароль должен содержать минимум одну букву и цифру'\n      }));\n      return;\n    }\n    try {\n      const response = await fetch('https://dummyjson.com/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: username,\n          password\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = 'Не удалось войти. Проверьте данные и попробуйте снова.';\n        if (errorData.errors && Array.isArray(errorData.errors)) {\n          errorMessage = errorData.errors[0].message || errorMessage;\n        }\n        throw new Error(errorMessage);\n      }\n      const data = await response.json();\n      localStorage.setItem('accessToken', data.accessToken);\n      localStorage.setItem('refreshToken', data.refreshToken);\n      dispatch(set_user(data));\n      dispatch(login());\n      setUsername('');\n      setPassword('');\n      navigate('/');\n      console.log('Авторизация успешна');\n    } catch (error) {\n      console.error('Произошла ошибка:', error);\n      handleError(error.message);\n    }\n  };\n  const handleError = error => {\n    setErrors(prev => ({\n      ...prev,\n      password: error\n    }));\n  };\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    switch (name) {\n      case 'username':\n        setUsername(value);\n        break;\n      case 'password':\n        setPassword(value);\n        break;\n      default:\n        break;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: styles.form,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: styles.title,\n          children: \"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u0443\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          placeholder: \"Username\",\n          value: username,\n          onChange: handleInputChange,\n          className: styles.input1,\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), errors.username && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.error,\n          children: errors.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n          value: password,\n          onChange: handleInputChange,\n          className: styles.input2,\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), errors.password && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.error,\n          children: errors.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          className: styles.button,\n          label: \"Войти\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginPage, \"LFHIETdfOrhoMoU+r5jAqBlmlwo=\", false, function () {\n  return [useDispatch, useNavigate];\n});\n_c = LoginPage;\nexport default LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["React","useState","styles","Button","useDispatch","login","set_user","NavBar","useNavigate","jsxDEV","_jsxDEV","LoginPage","_s","dispatch","username","setUsername","password","setPassword","errors","setErrors","navigate","validatePassword","length","test","handleSubmit","e","preventDefault","prev","response","fetch","method","headers","body","JSON","stringify","ok","errorData","json","errorMessage","Array","isArray","message","Error","data","localStorage","setItem","accessToken","refreshToken","console","log","error","handleError","handleInputChange","name","value","target","children","className","container","onSubmit","form","title","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onChange","input1","required","input2","button","label","_c","$RefreshReg$"],"sources":["/home/vadim/Desktop/react_task/src/pages/login-page/LoginPage.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport styles from './LoginPage.module.css';\nimport { Button } from '@consta/uikit/Button';\nimport { useDispatch } from 'react-redux';\nimport { login } from '../../components/app/slices/authSlice';\nimport { set_user } from '../../components/app/slices/userSlice';\n\nimport NavBar from '../../layouts/navigationBar';\nimport { useNavigate } from 'react-router-dom';\n\n\n\n\nfunction LoginPage() {\n  let dispatch = useDispatch(); \n\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState({\n    username: '',\n    password: ''\n  });\n\n  const navigate = useNavigate();\n\n  const validatePassword = (password) => {\n    return password.length >= 6 && /[a-zA-Z]/.test(password);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setErrors({\n      username: '',\n      password: ''\n    });\n\n    if (!validatePassword(password)) {\n      setErrors(prev => ({ ...prev, password: 'Пароль должен содержать минимум одну букву и цифру' }));\n      return;\n    }\n\n    try {\n      const response = await fetch('https://dummyjson.com/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ username: username, password }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = 'Не удалось войти. Проверьте данные и попробуйте снова.';\n        \n        if (errorData.errors && Array.isArray(errorData.errors)) {\n          errorMessage = errorData.errors[0].message || errorMessage;\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      const data = await response.json();\n\n      localStorage.setItem('accessToken', data.accessToken);\n      localStorage.setItem('refreshToken', data.refreshToken);\n\n      dispatch(set_user(data));\n      dispatch(login())\n\n      setUsername('');\n      setPassword('');\n\n      navigate('/')\n      console.log('Авторизация успешна');\n    } catch (error) {\n      console.error('Произошла ошибка:', error);\n      handleError(error.message);\n    }\n  };\n\n  const handleError = (error) => {\n    setErrors(prev => ({ ...prev, password: error }));\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n\n    switch (name) {\n      case 'username':\n        setUsername(value);\n        break;\n      case 'password':\n        setPassword(value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  return (\n    <div>\n      <div className={styles.container}>\n        <form onSubmit={handleSubmit} className={styles.form}>\n          <h2 className={styles.title}>Вход в систему</h2>\n          \n          <input\n            type=\"text\"\n            name=\"username\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={handleInputChange}\n            className={styles.input1}\n            required\n          />\n          {errors.username && <p className={styles.error}>{errors.username}</p>}\n          \n          <input\n            type=\"password\"\n            name=\"password\"\n            placeholder=\"Пароль\"\n            value={password}\n            onChange={handleInputChange}\n            className={styles.input2}\n            required\n          />\n          {errors.password && <p className={styles.error}>{errors.password}</p>}\n          \n          <Button type=\"submit\" className={styles.button} label={\"Войти\"}/>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}