{"ast":null,"code":"var _jsxFileName = \"/home/vadim/Desktop/react_task/src/pages/login-page/LoginPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport styles from './LoginPage.module.css';\nimport { Button } from '@consta/uikit/Button';\nimport { Text } from '@consta/uikit/Text';\nimport { useDispatch } from 'react-redux';\nimport { login } from '../../components/app/slices/authSlice';\nimport { set_user } from '../../components/app/slices/userSlice';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction LoginPage() {\n  _s();\n  let dispatch = useDispatch();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState({\n    username: '',\n    password: ''\n  });\n  const navigate = useNavigate();\n  const goToHomePage = () => {\n    navigate('/');\n  };\n  const goToServicePage = () => {\n    navigate('/services');\n  };\n  const goToLoginPage = () => {\n    navigate('/login');\n  };\n  const validatePassword = password => {\n    return password.length >= 6 && /[a-zA-Z]/.test(password);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setErrors({\n      username: '',\n      password: ''\n    });\n    if (!validatePassword(password)) {\n      setErrors(prev => ({\n        ...prev,\n        password: 'Пароль должен содержать минимум одну букву и цифру'\n      }));\n      return;\n    }\n    try {\n      const response = await fetch('https://dummyjson.com/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: username,\n          password\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = 'Не удалось войти. Проверьте данные и попробуйте снова.';\n        if (errorData.errors && Array.isArray(errorData.errors)) {\n          errorMessage = errorData.errors[0].message || errorMessage;\n        }\n        throw new Error(errorMessage);\n      }\n      const data = await response.json();\n      dispatch(set_user(data));\n      dispatch(login());\n      setUsername('');\n      setPassword('');\n      console.log('Авторизация успешна');\n    } catch (error) {\n      console.error('Произошла ошибка:', error);\n      handleError(error.message);\n    }\n  };\n  const handleError = error => {\n    setErrors(prev => ({\n      ...prev,\n      password: error\n    }));\n  };\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    switch (name) {\n      case 'username':\n        setUsername(value);\n        break;\n      case 'password':\n        setPassword(value);\n        break;\n      default:\n        break;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: styles.form,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: styles.title,\n          children: \"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0441\\u0438\\u0441\\u0442\\u0435\\u043C\\u0443\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          placeholder: \"Username\",\n          value: username,\n          onChange: handleInputChange,\n          className: styles.input1,\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this), errors.username && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.error,\n          children: errors.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          name: \"password\",\n          placeholder: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",\n          value: password,\n          onChange: handleInputChange,\n          className: styles.input2,\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), errors.password && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: styles.error,\n          children: errors.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 31\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          className: styles.button,\n          label: \"Войти\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginPage, \"LFHIETdfOrhoMoU+r5jAqBlmlwo=\", false, function () {\n  return [useDispatch, useNavigate];\n});\n_c = LoginPage;\nexport default LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["React","useState","styles","Button","Text","useDispatch","login","set_user","useNavigate","jsxDEV","_jsxDEV","LoginPage","_s","dispatch","username","setUsername","password","setPassword","errors","setErrors","navigate","goToHomePage","goToServicePage","goToLoginPage","validatePassword","length","test","handleSubmit","e","preventDefault","prev","response","fetch","method","headers","body","JSON","stringify","ok","errorData","json","errorMessage","Array","isArray","message","Error","data","console","log","error","handleError","handleInputChange","name","value","target","children","className","container","onSubmit","form","title","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onChange","input1","required","input2","button","label","_c","$RefreshReg$"],"sources":["/home/vadim/Desktop/react_task/src/pages/login-page/LoginPage.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport styles from './LoginPage.module.css';\nimport { Button } from '@consta/uikit/Button';\nimport { Text } from '@consta/uikit/Text';\nimport { useDispatch } from 'react-redux';\nimport { login } from '../../components/app/slices/authSlice';\nimport { set_user } from '../../components/app/slices/userSlice';\n\nimport { useNavigate } from 'react-router-dom';\n\n\nfunction LoginPage() {\n  let dispatch = useDispatch(); \n\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errors, setErrors] = useState({\n    username: '',\n    password: ''\n  });\n\n  const navigate = useNavigate();\n\n    const goToHomePage = () => {\n        navigate('/');\n    };\n\n    const goToServicePage = () => {\n        navigate('/services');\n    };\n\n    const goToLoginPage = () => {\n        navigate('/login');\n    };\n\n  const validatePassword = (password) => {\n    return password.length >= 6 && /[a-zA-Z]/.test(password);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setErrors({\n      username: '',\n      password: ''\n    });\n\n    if (!validatePassword(password)) {\n      setErrors(prev => ({ ...prev, password: 'Пароль должен содержать минимум одну букву и цифру' }));\n      return;\n    }\n\n    try {\n      const response = await fetch('https://dummyjson.com/auth/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ username: username, password }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        let errorMessage = 'Не удалось войти. Проверьте данные и попробуйте снова.';\n        \n        if (errorData.errors && Array.isArray(errorData.errors)) {\n          errorMessage = errorData.errors[0].message || errorMessage;\n        }\n\n        throw new Error(errorMessage);\n      }\n\n      const data = await response.json();\n      dispatch(set_user(data));\n      dispatch(login())\n\n      setUsername('');\n      setPassword('');\n      console.log('Авторизация успешна');\n    } catch (error) {\n      console.error('Произошла ошибка:', error);\n      handleError(error.message);\n    }\n  };\n\n  const handleError = (error) => {\n    setErrors(prev => ({ ...prev, password: error }));\n  };\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n\n    switch (name) {\n      case 'username':\n        setUsername(value);\n        break;\n      case 'password':\n        setPassword(value);\n        break;\n      default:\n        break;\n    }\n  };\n\n  return (\n    <div>\n      {/* <div>\n          <div className=\"header-left\">\n              <Button label=\"Главная\" onClick={goToHomePage} size=\"s\" className=\"header-button\" />\n              <Button label=\"Сервисы\" onClick={goToServicePage} size=\"s\" className=\"header-button\" />\n          </div>\n          <div className=\"header-right\">\n            <Text>Гость</Text>\n            <Button label=\"Войти\" onClick={goToLoginPage} size=\"s\" className=\"header-button\" />\n          </div>\n        </div> */}\n      <div className={styles.container}>\n        <form onSubmit={handleSubmit} className={styles.form}>\n          <h2 className={styles.title}>Вход в систему</h2>\n          \n          <input\n            type=\"text\"\n            name=\"username\"\n            placeholder=\"Username\"\n            value={username}\n            onChange={handleInputChange}\n            className={styles.input1}\n            required\n          />\n          {errors.username && <p className={styles.error}>{errors.username}</p>}\n          \n          <input\n            type=\"password\"\n            name=\"password\"\n            placeholder=\"Пароль\"\n            value={password}\n            onChange={handleInputChange}\n            className={styles.input2}\n            required\n          />\n          {errors.password && <p className={styles.error}>{errors.password}</p>}\n          \n          <Button type=\"submit\" className={styles.button} label={\"Войти\"}/>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}